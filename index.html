<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Move It - OKR Master</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root { --p: #2563eb; --bg: #f8fafc; --txt: #1e293b; }
        body { font-family: 'Segoe UI', system-ui; margin: 0; background: var(--bg); color: var(--txt); }
        nav { background: var(--txt); color: white; padding: 1rem; display: flex; justify-content: space-between; }
        .container { max-width: 800px; margin: 2rem auto; padding: 1rem; }
        .card { background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); margin-bottom: 1rem; }
        input { width: 100%; padding: 0.8rem; margin: 0.5rem 0; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        .btn { background: var(--p); color: white; border: none; padding: 0.8rem 1.5rem; border-radius: 6px; cursor: pointer; font-weight: bold; width: 100%; }
        .hidden { display: none; }
        .nav-links a { color: white; margin-left: 1rem; text-decoration: none; cursor: pointer; }
    </style>
</head>
<body>

<nav>
    <strong>üöÄ Move It OKRs</strong>
    <div class="nav-links">
        <a onclick="showSection('section-tips')">Tips OKR</a>
        <a onclick="showSection('section-about')">Sobre M√≠</a>
        <a id="logout-btn" class="hidden" onclick="logout()">Cerrar Sesi√≥n</a>
    </div>
</nav>

<div class="container">
    <section id="section-auth" class="card">
        <h2 id="auth-title">Iniciar Sesi√≥n</h2>
        <input type="email" id="email" placeholder="Tu email">
        <input type="password" id="password" placeholder="Tu contrase√±a">
        <button class="btn" onclick="handleAuth()" id="auth-main-btn">Entrar</button>
        <p style="text-align:center; font-size: 0.9rem;">
            <a onclick="toggleAuthMode()" id="auth-toggle">¬øNo tienes cuenta? Reg√≠strate</a><br><br>
            <a onclick="resetPassword()" style="color: grey;">Olvid√© mi contrase√±a</a>
        </p>
    </section>

    <section id="section-app" class="hidden">
        <h1>Mis OKRs Anuales</h1>
        <div id="okr-container">
            <div class="card">
                <h3>Objetivo: [Nombre del Objetivo]</h3>
                <p>‚Ä¢ KR1: M√©trica 1</p>
                <p>‚Ä¢ KR2: M√©trica 2</p>
                <p>‚Ä¢ KR3: M√©trica 3</p>
            </div>
        </div>
    </section>

    <section id="section-tips" class="hidden card">
        <h2>Tips para OKRs Reales</h2>
        <ul>
            <li><strong>Verbo de impacto:</strong> No uses "Hacer", usa "Aumentar", "Disminuir" o "Lograr".</li>
            <li><strong>La prueba del viernes:</strong> Si el viernes no puedes medir si avanzaste un n√∫mero, no es un KR.</li>
            <li><strong>Menos es m√°s:</strong> 4 objetivos es el l√≠mite f√≠sico para que un equipo mantenga el foco.</li>
        </ul>
        <button class="btn" onclick="showSection('section-app')">Volver al Panel</button>
    </section>

    <section id="section-about" class="hidden card">
        <h2>Sobre el Proyecto Move It</h2>
        <p>Este sistema est√° dise√±ado para durar. Utiliza tecnolog√≠as est√°ndar que no dependen de servidores propietarios fr√°giles.</p>
        <button class="btn" onclick="showSection('section-app')">Volver al Panel</button>
    </section>
</div>

<script>
    // CONFIGURACI√ìN SUPABASE (Reemplaza con tus llaves)
    const SUPABASE_URL = 'https://lddajpesoctuzlhjrpyg.supabase.co';
    const SUPABASE_KEY = 'sb_publishable_Ap9YMNrnBaD5Bluj38sWpQ_36j9QWm7';
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    let isSignUp = false;

    // Manejo de Interfaz
    function showSection(id) {
        document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
    }

    function toggleAuthMode() {
        isSignUp = !isSignUp;
        document.getElementById('auth-title').innerText = isSignUp ? 'Crear Cuenta' : 'Iniciar Sesi√≥n';
        document.getElementById('auth-main-btn').innerText = isSignUp ? 'Registrarse' : 'Entrar';
        document.getElementById('auth-toggle').innerText = isSignUp ? '¬øYa tienes cuenta? Entra' : '¬øNo tienes cuenta? Reg√≠strate';
    }

    // L√≥gica de Autenticaci√≥n
    async function handleAuth() {
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        if (isSignUp) {
            const { error } = await supabase.auth.signUp({ email, password });
            if (error) alert(error.message); else alert('Revisa tu email para confirmar tu cuenta');
        } else {
            const { error } = await supabase.auth.signInWithPassword({ email, password });
            if (error) alert(error.message); else checkUser();
        }
    }

    async function logout() {
        await supabase.auth.signOut();
        location.reload();
    }

    async function resetPassword() {
        const email = prompt("Ingresa tu email para recuperar contrase√±a:");
        if (email) {
            const { error } = await supabase.auth.resetPasswordForEmail(email);
            if (error) alert(error.message); else alert("Correo de recuperaci√≥n enviado.");
        }
    }

    async function checkUser() {
        const { data: { user } } = await supabase.auth.getUser();
        if (user) {
            showSection('section-app');
            document.getElementById('logout-btn').classList.remove('hidden');
            document.getElementById('section-auth').classList.add('hidden');
        }
    }

    checkUser();
</script>
</body>
</html>